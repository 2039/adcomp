<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>TMB Documentation: Statistical toolbox</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TMB Documentation
   &#160;<span id="projectnumber">v1.7.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Statistical toolbox</div>  </div>
</div><!--header-->
<div class="contents">

<p>Collection of useful statistical techniques.  
<a href="#details">More...</a></p>
<p>Collection of useful statistical techniques. </p>
<p>First read the <em>Statistical Modelling</em> section of <a class="el" href="group__Tutorial.html">Getting started</a>.</p>
<h3>Non-normal latent variables (random effects)</h3>
<p>The underlying latent random variables in TMB must be Gaussian for the Laplace approximation to be accurate. To obtain other distributions, say a gamma distribution, the "transformation trick" can be used. We start out with normally distributed variables <code>u</code> and transform these into new variables <code>w</code> via the <code>pnorm</code> and <code>qgamma</code> functions as follows: </p><div class="fragment"><div class="line"><a class="code" href="group__macros.html#ga6b8a70eeee38fe896e89e0a9c6bef84a">PARAMETER_VECTOR</a>(u);                             <span class="comment">// Underlying latent random variables </span></div><div class="line">Type nll=Type(0.0);</div><div class="line">nll -= <a class="code" href="convenience_8hpp.html#a1fe3cb777e8fd8080385579ab87600e3">sum</a>(dnorm(u,Type(0),Type(1),<span class="keyword">true</span>));       <span class="comment">// Assign N(0,1) distribution u </span></div><div class="line"><a class="code" href="structvector.html">vector&lt;Type&gt;</a> v = <a class="code" href="group__R__style__distribution.html#gac908a1b293d159f4a8958a694674a4a4">pnorm</a>(u,Type(0),Type(1),<span class="keyword">true</span>);  <span class="comment">// Uniformly distributed variables (on [0,1])</span></div><div class="line"><a class="code" href="structvector.html">vector&lt;Type&gt;</a> w = <a class="code" href="group__R__style__distribution.html#gae9f8112d1f1ee80879c8e91b7bffac55">qgamma</a>(v,shape,scale,<span class="keyword">true</span>);</div></div><!-- fragment --><p> <code>w</code> now has a gamma distribution.</p>
<h3>Discrete latent variables</h3>
<p>The Laplace approximation can not be applied to discrete latent variables that occur in mixture models and HMMs (Hidden Markov models). However, such likelihoods have analytic expressions, and may be coded up in TMB. TMB would still calculate the exact gradient of the HMM likelihood.</p>
<h3>Mixture models </h3>
<p>Althought mixture mode are a special case of discrete latent variable models, they do diserve special attention. Consider the case that we want a mixture of two zero-mean normal distributions (with different standard deviations). This can be implemented as: </p><div class="fragment"><div class="line"><a class="code" href="group__macros.html#gad334262a7679f343bdc919ae35810161">DATA_VECTOR</a>(x);                               </div><div class="line"><a class="code" href="group__macros.html#ga6b8a70eeee38fe896e89e0a9c6bef84a">PARAMETER_VECTOR</a>(sigma);      <span class="comment">// sigma0 og sigma1</span></div><div class="line"><a class="code" href="group__macros.html#ga70b2d449f7c53e87abee7d5fb71dc4c0">PARAMETER</a>(p);                 <span class="comment">// Mixture proportion of model 0</span></div><div class="line">Type nll=Type(0.0);</div><div class="line">nll -= <a class="code" href="convenience_8hpp.html#a1fe3cb777e8fd8080385579ab87600e3">sum</a>(log(p*dnorm(x,Type(0),sigma(0),<span class="keyword">false</span>)</div><div class="line">                                      +(Type(1)-p)*dnorm(x,Type(0),sigma(1),<span class="keyword">false</span>)));</div></div><!-- fragment --><h3>Time series</h3>
<p>Autoregressive (AR) processes may be implemented using the compact notation of section <a class="el" href="group__Densities.html">Multivariate distributions</a>. The resulting AR process may be applied both in the observational part and in the distribution of a latent variable.</p>
<p>Nonlinear time must be implemented from scratch, as in the example <a class="el" href="thetalog_8cpp-example.html">thetalog.cpp</a></p>
<h3>Spatial models</h3>
<p>TMB has strong support for spatial model and space-time models via the <a class="el" href="density_8hpp.html#ab290ba244619df01db9f48570dbbf91a">GMRF</a> and <a class="el" href="density_8hpp.html#afd76474bb73fa9af11b9dfb6c11f0c57">SEPARABLE</a> functions, and the notion of a <code>distribution</code>. The reader is referred to section <a class="el" href="group__Densities.html">Multivariate distributions</a> for details and examples. </p>
</div><!-- contents -->
License: <a href="https://gnu.org/licenses/old-licenses/gpl-2.0.txt">GPL v2</a>
